<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Log Workout | FitTrack</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<div class="page-container">
  <h2>Log Your Workout</h2>
  <form id="workout-form">
    <label for="exercise">Exercise Name</label>
    <input type="text" id="exercise" required placeholder="e.g. Push-ups" />

    <label for="calories">Calories Burned</label>
    <input type="number" id="calories" required placeholder="e.g. 150" />

    <button type="submit">Save Workout</button>
  </form>

  <div class="history-box">
    <h3>Workout History</h3>
    <div id="workout-history"></div>
  </div>

  <div class="nav-links">
    <div class="nav-btn" onclick="window.location.href='dashboard.html'">← Back to Dashboard</div>
    <div class="nav-btn" onclick="window.location.href='meal.html'">→ Log Meal</div>
  </div>
</div>
<script>
  document.getElementById("workout-form").addEventListener("submit", function (e) {
    e.preventDefault();

    const exercise = document.getElementById("exercise").value.trim();
    const calories = parseInt(document.getElementById("calories").value);

    if (!exercise || isNaN(calories)) {
      alert("Please enter valid workout details.");
      return;
    }

    let totalBurned = parseInt(localStorage.getItem("caloriesBurned")) || 0;
    totalBurned += calories;
    localStorage.setItem("caloriesBurned", totalBurned);

    const logs = JSON.parse(localStorage.getItem("workoutLogs")) || [];
    logs.push({
      exercise,
      calories,
      date: new Date().toLocaleString()
    });
    localStorage.setItem("workoutLogs", JSON.stringify(logs));

    alert("Workout saved successfully!");
    location.reload();
  });

  window.onload = function () {
    const historyBox = document.getElementById("workout-history");
    const logs = JSON.parse(localStorage.getItem("workoutLogs")) || [];

    if (logs.length > 0) {
      logs.slice().reverse().forEach((log, reverseIndex) => {
        const index = logs.length - 1 - reverseIndex;
        const div = document.createElement("div");
        div.className = "history-entry";
        div.innerHTML = `
          <strong>${log.exercise}</strong> - ${log.calories} kcal<br>
          <small>${log.date}</small>
          <br><button onclick="deleteWorkout(${index})" class="delete-btn">Delete</button>
        `;
        historyBox.appendChild(div);
      });
    } else {
      historyBox.innerHTML = "<p>No workouts yet.</p>";
    }
  };

  function deleteWorkout(index) {
    const logs = JSON.parse(localStorage.getItem("workoutLogs")) || [];
    const removed = logs.splice(index, 1)[0];
    localStorage.setItem("workoutLogs", JSON.stringify(logs));

    let total = parseInt(localStorage.getItem("caloriesBurned")) || 0;
    total -= removed.calories;
    localStorage.setItem("caloriesBurned", total);

    location.reload();
  }
</script>
</body>
</html>
